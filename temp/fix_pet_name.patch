--- handlers_old.py	2026-01-31 15:32:00
+++ handlers_fixed.py	2026-01-31 15:45:00
@@ -620,27 +620,36 @@
 
 @router.message(OrderForm.waiting_pet_name)
 async def process_pet_name(message: Message, state: FSMContext):
-    """Обработка имени питомца"""
+    """Обработка имени питомца - ИСПРАВЛЕННАЯ ВЕРСИЯ"""
     pet_name = message.text.strip()
     data = await state.get_data()
     user_info = data.get('user_info', {})
     
-    # Проверяем, хочет ли пользователь оставить текущее имя
-    if pet_name == '+' and user_info.get('pet_name'):
-        pet_name = user_info['pet_name']
+    # Если у пользователя уже есть pet_name в БД, используем его
+    existing_pet_name = user_info.get('pet_name')
+    
+    if existing_pet_name and existing_pet_name.strip():
+        # У пользователя уже есть имя питомца в БД
+        # Проверяем не хочет ли он его изменить
+        if pet_name == '+':
+            # Оставляем текущее имя
+            pet_name = existing_pet_name
+            print(f"✅ Используем существующее имя питомца: {pet_name}")
+        elif len(pet_name) >= 2:
+            # Пользователь ввел новое имя
+            print(f"✅ Изменяем имя питомца: {existing_pet_name} → {pet_name}")
+        else:
+            # Слишком короткое имя, запрашиваем снова
+            await message.answer("❌ Слишком короткое имя. Введите имя питомца:")
+            return
     else:
-        if len(pet_name) < 2:
-            # Удаляем предыдущее сообщение о запросе имени
-            try:
-                await message.delete()
-            except:
-                pass  # Игнорируем ошибки удаления
-
-            await message.answer("❌ Слишком короткое имя. Введите имя питомца:")
+        # У пользователя нет имени питомца в БД
+        if len(pet_name) < 2:
+            await message.answer("❌ Слишком короткое имя. Введите имя питомца (минимум 2 символа):")
             return
     
     await state.update_data(pet_name=pet_name)
-    
+
     # Шаг 2: Адрес доставки
     await state.set_state(OrderForm.waiting_address)
     
